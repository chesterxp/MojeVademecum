"use strict";function geoCheck(){var e=document.querySelector(".browser_suport"),o=document.querySelector(".user_localisation"),t=document.querySelector(".geoBtn");function i(e){o.innerHTML="Twoja lokalizacja to:"+e.coords.latitude+" , "+e.coords.longitude}function n(e){var t;switch(e.code){case e.PERMISSION_DENIED:t="Brak pozwolenia na znalezienie lokalizacji.";break;case e.POSITION_UNAVAILABLE:t="Brak dostępu do sieci.";break;case e.TIMEOUT:t="Przekroczono czas oczekiwania."}o.innerHTML="<strong>Wystąpił błąd: </strong>"+t}navigator.geolocation?e.innerHTML="Twoja przeglądarka wspiera Geolokalizacje":(e.innerHTML="Twoja przeglądarka nie wspiera Geolokalizacji",e.style.color="red");var a={timeout:5e3};t.addEventListener("click",function(){o.innerHTML="Czekaj ...",navigator.geolocation.getCurrentPosition(i,n,a)})}geoCheck();var map={init:function(){try{google.maps.event.addDomListener(window,"load",this.makeMap.bind(this))}catch(e){return}this.location="52.2398319,21.031668",this.mapForm=document.querySelector("#mapOptions"),this.showRoadBTN=document.querySelector(".showRoadBTN"),this.fromInput=document.querySelector("#from"),this.path=new google.maps.DirectionsService,this.pathRender=new google.maps.DirectionsRenderer,this.mapForm.addEventListener("submit",function(e){e.preventDefault(),this.prepareRoute()}.bind(this)),this.showRoadBTN.addEventListener("click",function(){this.prepareRoute()}.bind(this)),this.checkGeoSupport()},makeMap:function(){var e=this.location.split(","),t=new google.maps.LatLng(e[0],e[1]),o={zoom:16,center:t,mapTypeId:google.maps.MapTypeId.ROADMAP};this.mapObj=new google.maps.Map(document.querySelector("#map"),o),this.destination=t;new google.maps.Marker({map:this.mapObj,position:t,animation:google.maps.Animation.BOUNCE,icon:"../../img/map_marker.png"})},prepareRoute:function(e){var t={map:this.mapObj,polylineOptions:{strokeColor:"#ff0000",strokeWeight:4,strokeOpacity:.8},suppressMarkers:!0};this.pathRender.setOptions(t);var o={origin:e||this.fromInput.value,destination:this.destination,travelMode:google.maps.DirectionsTravelMode.DRIVING};this.path.route(o,this.handleRoute.bind(this))},handleRoute:function(e,t){if(t!=google.maps.DirectionsStatus.OK||!e.routes[0])return alert("Wprowadziłeś złe dane!"),!1;this.pathRender.setDirections(e),this.fromInput.value=e.routes[0].legs[0].start_address},checkGeoSupport:function(){if(navigator.geolocation){var e=document.querySelector(".whereAmI");e.classList.remove("hidden"),e.addEventListener("click",function(e){e.preventDefault(),this.getGeoData()}.bind(this))}},getGeoData:function(){var e=function(e){this.prepareRoute(e.coords.latitude+","+e.coords.longitude)}.bind(this);navigator.geolocation.getCurrentPosition(e,function(e){alert("Wystąpił błąd! Odśwież stronę i spróbuj ponownie.")},{enableHighAccuracy:!0})}};map.init();